{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h1>Deleted Records</h1>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Client Name</th>
                <th>Company</th>
                <th>Assigned To</th> <!-- Added Assigned To Column -->
                <th>Deleted By</th>
                <th>Deleted At</th>
                <th>Reason</th> <!-- Added deletion reason -->
                <th>Details</th>
            </tr>
        </thead>
        <tbody>
            {% for item in history %}
            <tr>
                <td>{{ item.record_id }}</td>
                <td>{{ item.client_name }}</td>
                <td>{{ item.company }}</td>
                <td>
                    {% if item.assigned_to %}
                        {{ item.assigned_to.username }}
                    {% else %}
                        <em>Unassigned</em>
                    {% endif %}
                </td> <!-- Display Assigned To User -->
                <td>{{ item.deleted_by.username }}</td>
                <td>{{ item.deleted_at|date:"F d, Y, H:i" }}</td>
                <td>{{ item.deletion_reason }}</td> <!-- Display the reason -->
                <td>
                    <a href="{% url 'deleted_record_detail' item.id %}" class="btn btn-info">
                        View Details
                    </a>
                </td>
            </tr>

            {% endfor %}
        </tbody>
    </table>
      <!-- Export Button -->
    <a href="{% url 'export_deleted_records' %}" class="btn btn-success mb-3">
        Export Deleted Records
    </a>
</div>
{% endblock %}
