{% extends 'base.html' %}

{% block content %}
<div class="container">
    <h2>Update Potential Lead</h2>
    <form method="POST" action="">
        {% csrf_token %}
        {{ form.non_field_errors }}

        <div class="form-group">
            <label for="company">Company</label>
            {{ form.company }}
            {% if form.company.errors %}
                <div class="text-danger">
                    {{ form.company.errors }}
                </div>
            {% endif %}
        </div>

        <div class="form-group">
            <label for="client_name">Client Name</label>
            {{ form.client_name }}
            {% if form.client_name.errors %}
                <div class="text-danger">
                    {{ form.client_name.errors }}
                </div>
            {% endif %}
        </div>

        <div class="form-group">
            <label for="phone">Phone</label>
            {{ form.phone }}
            {% if form.phone.errors %}
                <div class="text-danger">
                    {{ form.phone.errors }}
                </div>
            {% endif %}
        </div>

        <div class="form-group">
            <label for="email">Email</label>
            {{ form.email }}
            {% if form.email.errors %}
                <div class="text-danger">
                    {{ form.email.errors }}
                </div>
            {% endif %}
        </div>

        <div class="form-group">
            <label for="comments">Comments</label>
            {{ form.comments }}
            {% if form.comments.errors %}
                <div class="text-danger">
                    {{ form.comments.errors }}
                </div>
            {% endif %}
        </div>

        <div class="form-group">
            <label for="follow_up_date">Follow-up Date</label>
            {{ form.follow_up_date }}
            {% if form.follow_up_date.errors %}
                <div class="text-danger">
                    {{ form.follow_up_date.errors }}
                </div>
            {% endif %}
        </div>

        <div class="form-group">
            <label for="conversation">Conversation</label>
            {{ form.conversation }}
            {% if form.conversation.errors %}
                <div class="text-danger">
                    {{ form.conversation.errors }}
                </div>
            {% endif %}
        </div>

        <!-- Section for Additional Comments -->
        <div id="additional-comments-section" class="form-group mt-4">
            <label for="additional-comments">Additional Comments</label>
            <div id="additional-comments-container">
                <!-- Additional comments will be added here -->
            </div>
            <button type="button" id="add-comment-btn" class="btn btn-warning mt-2">
                Add Comment
            </button>
        </div>

        <br>
        <button type="submit" class="btn btn-primary">Update Lead</button>
        <a href="{% url 'potential_leads' %}" class="btn btn-secondary">Cancel</a>
    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const addCommentBtn = document.getElementById('add-comment-btn');
        const commentsContainer = document.getElementById('additional-comments-container');

        addCommentBtn.addEventListener('click', function () {
            // Create a new textarea for an additional comment
            const newCommentField = document.createElement('textarea');
            newCommentField.setAttribute('name', 'additional_comments[]');  // Name it as an array
            newCommentField.setAttribute('class', 'form-control mt-2');
            newCommentField.setAttribute('rows', '3');
            newCommentField.setAttribute('placeholder', 'Add another comment...');

            // Append the new comment field to the container
            commentsContainer.appendChild(newCommentField);
        });
    });
</script>
{% endblock %}
